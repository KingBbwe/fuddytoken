$w.onReady(function () {
    const button = $w('#connectWalletButton');
    if (button) {
        button.onClick(async () => {
            if (typeof window !== "undefined" && window.ic && window.ic.plug) {
                try {
                    // Use the Plug Wallet's connect method to request a connection
                    const connected = await window.ic.plug.requestConnect({
                        whitelist: ["your_canister_id"],
                        timeout: 5000 // optional timeout value
                    });

                    if (connected) {
                        const userPrincipal = await window.ic.plug.agent.getPrincipal();
                        console.log('Wallet connected. User Principal:', userPrincipal);
                        // Optionally, show a message to the user or proceed with your logic
                    } else {
                        console.error('Connection to Plug Wallet failed');
                        // Optionally, show a message to the user
                    }
                } catch (e) {
                    console.error('Error connecting to Plug Wallet:', e);
                    // Optionally, show a message to the user
                }
            } else {
                console.log('Plug Wallet extension is not installed!');
                alert('Please install the Plug Wallet extension to connect your wallet.');
            }
        });
    } else {
        console.error('Button with ID connectWalletButton not found');
    }
});
